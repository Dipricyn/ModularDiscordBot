<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: plugins/pluginManagement/pluginmanagementplugin.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: plugins/pluginManagement/pluginmanagementplugin.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const Plugin = require('./../../plugin.js');
const Command = require('./../../command.js');

/**
 * PluginManagementPlugin enables starting and stopping plugins via commands
 * and provides a list of commands of all the plugins.
 */
class PluginManagementPlugin extends Plugin {

    constructor(bot) {
        super("pluginmanagement")
        this.bot = bot
        this.handleStartCommand = this.handleStartCommand.bind(this)
        this.handleStopCommand = this.handleStopCommand.bind(this)
        this.handleCommandsCommand = this.handleCommandsCommand.bind(this)
        this.handlePluginsCommand = this.handlePluginsCommand.bind(this)
        this.commandContainer.add(new Command()
            .setIdentifier("start")
            .setHandler(this.handleStartCommand)
            .setOptions({
                requiredChannelType: "direct",
                elevated: true
            })
        )
        this.commandContainer.add(new Command()
            .setIdentifier("stop")
            .setHandler(this.handleStopCommand)
            .setOptions({
                requiredChannelType: "direct",
                elevated: true
            })
        )
        this.commandContainer.add(new Command()
            .setIdentifier("plugins")
            .setHandler(this.handlePluginsCommand)
            .setOptions({
                requiredChannelType: "direct",
                elevated: true
            })
        )
        this.commandContainer.add(new Command()
            .setIdentifier("commands")
            .setHandler(this.handleCommandsCommand)
        )
    }

    handleStartCommand(args, message) {
        const channel = message.channel
        const res = this.bot.pluginContainer.startPlugin(args[0], true)
        if(res.success) {
            channel.send(`Successfully started plugin '${args[0]}'.`)
        } else {
            channel.send(res.msg)
        }
    }

    handleStopCommand(args, message) {
        const channel = message.channel
        const res = this.bot.pluginContainer.stopPlugin(args[0], true)
        if(res.success) {
            channel.send(`Successfully stopped plugin '${args[0]}'.`)
        } else {
            channel.send(res.msg)
        }
    }

    handleCommandsCommand(args, message) {
        const channel = message.channel
        let commands = []
        for(const plugin of this.bot.pluginContainer.values()) {
            for(const identifier of plugin.commandContainer.keys()) {
                commands.push(identifier)
            }
        }
        commands.sort()
        let commandsStr = "Commands:\n"
        for(const identifier of commands){
            commandsStr += `!${identifier}\n`
        }
        channel.send(commandsStr)
    }

    handlePluginsCommand(args, message) {
        const channel = message.channel
        let pluginsStr = "Plugins states:\n"
        for(const [identifier, plugin] of this.bot.pluginContainer) {
            pluginsStr += `${identifier}:\n\tcurrently running: ${plugin.running}, `
            pluginsStr += `persistently running: ${this.bot.pluginContainer.getPersistentState(identifier)}\n`
        }
        channel.send(pluginsStr)
    }
}
module.exports = PluginManagementPlugin</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Command.html">Command</a></li><li><a href="CommandHidingPlugin.html">CommandHidingPlugin</a></li><li><a href="NoticeMePlugin.html">NoticeMePlugin</a></li><li><a href="Plugin.html">Plugin</a></li><li><a href="PluginContainer.html">PluginContainer</a></li><li><a href="PluginManagementPlugin.html">PluginManagementPlugin</a></li><li><a href="SoundboardPlugin.html">SoundboardPlugin</a></li></ul><h3>Global</h3><ul><li><a href="global.html#loadJSONSyncIfExists">loadJSONSyncIfExists</a></li><li><a href="global.html#writeJSONObjectSyncIfNotExists">writeJSONObjectSyncIfNotExists</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
